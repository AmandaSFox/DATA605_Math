<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Amanda Fox">
<meta name="dcterms.date" content="2025-04-13">

<title>DATA_605_Assignment_2_Fox</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Assignment 2 - Fox_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assignment 2 - Fox_files/libs/quarto-html/quarto.js"></script>
<script src="Assignment 2 - Fox_files/libs/quarto-html/popper.min.js"></script>
<script src="Assignment 2 - Fox_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assignment 2 - Fox_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assignment 2 - Fox_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assignment 2 - Fox_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assignment 2 - Fox_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assignment 2 - Fox_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assignment 2 - Fox_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DATA_605_Assignment_2_Fox</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Amanda Fox </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 13, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="preparation" class="level2">
<h2 class="anchored" data-anchor-id="preparation">Preparation</h2>
<p>Load libraries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Matrix)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(markovchain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="problem-1" class="level2">
<h2 class="anchored" data-anchor-id="problem-1">Problem 1</h2>
<section id="bayesian" class="level3">
<h3 class="anchored" data-anchor-id="bayesian">1. Bayesian</h3>
<p><strong>(Bayesian): A new credit scoring system has been developed to predict the likelihood of loan defaults. The system has a 90% sensitivity, meaning that it correctly identifies 90% of those who will default on their loans. It also has a 95% specificity, meaning that it correctly identifies 95% of those who will not default. The default rate among borrowers is 2%.</strong></p>
<p>First I set up a confusion matrix: this is an extra step but it is helpful to visualize everything first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>n_borrowers <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>p_default <span class="ot">=</span> .<span class="dv">02</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>sensitivity <span class="ot">=</span> .<span class="dv">9</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>specificity <span class="ot">=</span> .<span class="dv">95</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>n_default <span class="ot">=</span> n_borrowers <span class="sc">%*%</span> p_default</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>n_no_default <span class="ot">=</span> n_borrowers <span class="sc">-</span> n_default</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>M_default <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(n_default <span class="sc">%*%</span> sensitivity, n_default <span class="sc">%*%</span> (<span class="dv">1</span><span class="sc">-</span>sensitivity),n_default,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                      n_no_default <span class="sc">%*%</span> (<span class="dv">1</span><span class="sc">-</span>specificity),n_no_default <span class="sc">%*%</span> specificity,n_no_default,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                      (n_default <span class="sc">%*%</span> sensitivity)<span class="sc">+</span> (n_no_default <span class="sc">%*%</span> (<span class="dv">1</span><span class="sc">-</span>specificity)),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                      (n_default <span class="sc">%*%</span> (<span class="dv">1</span><span class="sc">-</span>sensitivity)) <span class="sc">+</span> (n_no_default <span class="sc">%*%</span> specificity),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                      n_default <span class="sc">+</span> n_no_default),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(M_default) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Default"</span>,<span class="st">"No Default"</span>,<span class="st">"Total"</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(M_default) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Risk Flag"</span>,<span class="st">"No Risk Flag"</span>,<span class="st">"Total"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>M_default</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Risk Flag No Risk Flag Total
Default          180           20   200
No Default       490         9310  9800
Total            670         9330 10000</code></pre>
</div>
</div>
<p><strong>Given these prevalence, sensitivity, and specificity estimates, what is the probability that a borrower flagged by the system as likely to default will actually default?</strong></p>
<p>Using the matrix above, the probability of a flagged borrower defaulting (a true positive) is <strong>~0.269</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> M_default[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>total_defaults <span class="ot">&lt;-</span> M_default[<span class="dv">3</span>,<span class="dv">1</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>prob_tp <span class="ot">&lt;-</span> tp<span class="sc">/</span>total_defaults</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>prob_tp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2686567</code></pre>
</div>
</div>
<p><strong>If the average loss per defaulted loan is $200,000 and the cost to run the credit scoring test on each borrower is $500, what is the total first-year cost for evaluating 10,000 borrowers?</strong></p>
<p>If the model were used in a process to <strong>deny all flagged loans</strong>, the first-year cost would be <strong>$9 million</strong>: 20 false negatives would still get loans and default, at a cost of $4 million in addition to the $5 million cost of the tests.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>) <span class="co">#no scientific notation</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>avg_cost <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>avg_loss <span class="ot">&lt;-</span> <span class="dv">200000</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># cost of tests for all borrowers</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>test_cost <span class="ot">&lt;-</span> n_borrowers <span class="sc">%*%</span> avg_cost</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>test_cost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]
[1,] 5000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># deny all flagged loans: 20 false negatives still get loans and default</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> M_default[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>total_cost <span class="ot">&lt;-</span> test_cost <span class="sc">+</span> (avg_loss <span class="sc">%*%</span> fn) </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>total_cost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]
[1,] 9000000</code></pre>
</div>
</div>
</section>
<section id="binomial" class="level3">
<h3 class="anchored" data-anchor-id="binomial">2. Binomial</h3>
<p><strong>The probability that a stock will pay a dividend in any given quarter is 0.7.</strong></p>
<p><strong>Probabilities</strong></p>
<p>The dbinom function in R gives the probability of an exact number of successes in a binomial distribution:</p>
<p><em>What is the probability that the stock pays dividends exactly 6 times in 8 quarters?</em></p>
<p><strong>0.296</strong></p>
<p><em>What is the probability that it pays dividends 6 or more times? </em></p>
<p><strong>0.552</strong></p>
<p><em>What is the probability that it pays dividends fewer than 6 times?</em></p>
<p><strong>0.448</strong></p>
<p><strong>What is the expected number of dividend payments over 8 quarters?</strong></p>
<p>The expected number of payments is simply n * p:<br>
<strong>5.6</strong></p>
<p><strong>What is the standard deviation?</strong></p>
<p>The standard deviation is <span class="math inline">\(\frac{np}{1-p}\)</span>:<br>
<strong>1.296</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>n_binom <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>p_binom <span class="ot">&lt;-</span> .<span class="dv">7</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># prob of 6</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>p_binom_6 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">6</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> n_binom, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prob =</span> p_binom)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>p_binom_6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2964755</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prob of 6-8</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>p_binom_6_8 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> n_binom, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prob =</span> p_binom))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>p_binom_6_8</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5517738</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prob of &lt;6</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>p_binom_0_5 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> n_binom, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prob =</span> p_binom))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>p_binom_0_5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4482262</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>expected_binom <span class="ot">&lt;-</span> n_binom <span class="sc">%*%</span> p_binom</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>expected_binom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]  5.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># std dev</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>sd_binom <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(n_binom <span class="sc">%*%</span> p_binom <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span> p_binom))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>sd_binom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
[1,] 1.296148</code></pre>
</div>
</div>
</section>
<section id="poisson" class="level3">
<h3 class="anchored" data-anchor-id="poisson">3. Poisson</h3>
<p><strong>A financial analyst notices that there are an average of 12 trading days each month when a certain stock’s price increases by more than 2%.</strong></p>
<p><strong>Probabilities</strong></p>
<p><em>What is the probability that exactly 4 such days occur in a given month?</em></p>
<p>The dpois function in R gives the probability of an exact number of successes in a poisson distribution:<br>
<strong>0.005</strong></p>
<p><em>What is the probability that more than 12 such days occur in a given month?</em></p>
<p>Assuming there is no upper limit on the days (or trading days) in a month, we can use ppois function in R to find the probability of <span class="math inline">\(\leq 12\)</span> and subtract that from 1:<br>
<strong>0.424</strong></p>
<p><strong>How many such days would you expect in a 6-month period?</strong></p>
<p>Expected = <span class="math inline">\(\lambda\)</span> * number of months<br>
<strong>72</strong></p>
<p><strong>What is the standard deviation of the number of such days?</strong></p>
<p>Standard deviation = <span class="math inline">\(\sqrt \lambda\)</span><br>
<strong>~3.464</strong></p>
<p><strong>If an investment strategy requires at least 70 days of such price increases in a year for profitability, what is the percent utilization and what are your recommendations?</strong></p>
<p>The expected number of days with price increases over 2% in 12 months is 144, so the percent utilization is <strong>205.7%</strong> and the probability of having 70 or more such days is <strong>1.00</strong>. Therefore I would recommend moving forward with the investment strategy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>lambda_month <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># prob of 4</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>prob_pois_4 <span class="ot">&lt;-</span> <span class="fu">dpois</span>(<span class="at">x =</span> <span class="dv">4</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">lambda =</span> lambda_month)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>prob_pois_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.005308599</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prob &gt;12, not limited to actual days in month</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>prob_pois_more_than_12 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(<span class="fu">ppois</span>(<span class="at">q =</span> <span class="dv">12</span>, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">lambda =</span> lambda_month))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>prob_pois_more_than_12</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4240348</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected in six months</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>lambda_6months <span class="ot">&lt;-</span> lambda_month <span class="sc">%*%</span> <span class="dv">6</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>lambda_6months</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   72</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># std dev</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>sd_pois <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(lambda_month)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>sd_pois</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.464102</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected in 12 months</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>lambda_12months <span class="ot">&lt;-</span> lambda_month <span class="sc">%*%</span> <span class="dv">12</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>lambda_12months</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]  144</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pct_util_12mo <span class="ot">&lt;-</span> lambda_12months<span class="sc">/</span><span class="dv">70</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>pct_util_12mo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
[1,] 2.057143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>prob_pois_more_than_69 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(<span class="fu">ppois</span>(<span class="at">q =</span> <span class="dv">69</span>, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">lambda =</span> lambda_12months))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>prob_pois_more_than_69</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="hypergeometric" class="level3">
<h3 class="anchored" data-anchor-id="hypergeometric">4. Hypergeometric</h3>
<p><strong>A hedge fund has a portfolio of 25 stocks, with 15 categorized as high-risk and 10 as low-risk.The fund manager randomly selects 7 stocks to closely monitor.</strong></p>
<p><strong>If the manager selected 5 high-risk stocks and 2 low-risk stocks, what is the probability of selecting exactly 5 high-risk stocks if the selection was random?</strong></p>
<p>The hypergeometic distribution represents taking a sample without replacement where K is the total number of successes (in this case, high risk stocks) in the population N.</p>
<p>As in the examples above, we can use the “d” version of the distribution function, or dhyper, to find probabilities of exactly 5 successes in sample n=7:<br>
<strong>0.281</strong></p>
<p><strong>How many high-risk and low-risk stocks would you expect to be selected?</strong></p>
<p>The expected number of successes in sample n=7 is found by <span class="math inline">\(n \cdot \frac{K}{N}\)</span>:<br>
<strong>4.2 high risk, 2.8 low risk</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>N_hyper <span class="ot">&lt;-</span> <span class="dv">25</span> <span class="co">#total N</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>K_hyper <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co">#total successes</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>n_hyper <span class="ot">&lt;-</span> <span class="dv">7</span>  <span class="co">#sample drawn</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># prob of 5 successes in the sample</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>x_hyper <span class="ot">&lt;-</span> <span class="dv">5</span>  <span class="co">#desired successes</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>prob_hyper_5 <span class="ot">&lt;-</span> <span class="fu">dhyper</span>(x_hyper,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>                       K_hyper,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>                       N_hyper<span class="sc">-</span>K_hyper,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>                       n_hyper)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>prob_hyper_5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2811213</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected x</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>expected_hyper <span class="ot">&lt;-</span> n_hyper <span class="sc">%*%</span> (K_hyper<span class="sc">/</span>N_hyper)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>expected_hyper</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]  4.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected not x</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>n_hyper <span class="sc">-</span> expected_hyper</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]  2.8</code></pre>
</div>
</div>
</section>
<section id="geometric" class="level3">
<h3 class="anchored" data-anchor-id="geometric">5. Geometric</h3>
<p><strong>The probability that a bond defaults in any given year is 0.5%. A portfolio manager holds this bond for 10 years.</strong></p>
<p><strong>Probabilities</strong><br>
This is a geometric distribution modeling the number of trials (years) until the first success (default). As above we can use the “p” version of the distribution function or “pgeom” to find the probability of success in <span class="math inline">\(\leq q\)</span> years:</p>
<p><em>What is the probability that the bond will default during this period?</em></p>
<p><strong>0.489</strong></p>
<p><em>What is the probability that it will default in the next 15 years?</em></p>
<p><strong>0.072</strong></p>
<p><strong>What is the expected number of years before the bond defaults?</strong></p>
<p>Expected = <span class="math inline">\(\frac{1}{p}\)</span><br>
<strong>200</strong></p>
<p><strong>If the bond has already survived 10 years, what is the probability that it will default in the next 2 years?</strong></p>
<p>Surviving 10 years is not relevant; find probability of defaulting in 2 years:<br>
<strong>0.010</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>p_geom <span class="ot">&lt;-</span> .<span class="dv">005</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># prob default by year 10</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>prob_geom_10 <span class="ot">&lt;-</span> <span class="fu">pgeom</span>(<span class="dv">9</span>,p_geom) <span class="co">#up to 9 FAILURES (not 10 successes)</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>prob_geom_10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04888987</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prob default by year 15</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>prob_geom_15 <span class="ot">&lt;-</span> <span class="fu">pgeom</span>(<span class="dv">14</span>,p_geom) </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>prob_geom_15</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07243103</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected years before default</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>exp_geom <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>p_geom</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>exp_geom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 200</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prob default by year 2</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>prob_geom_2 <span class="ot">&lt;-</span> <span class="fu">pgeom</span>(<span class="dv">1</span>,p_geom) </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>prob_geom_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.009975</code></pre>
</div>
</div>
</section>
<section id="poisson-1" class="level3">
<h3 class="anchored" data-anchor-id="poisson-1">6. Poisson</h3>
<p><strong>A high-frequency trading algorithm experiences a system failure about once every 1500 trading hours.</strong></p>
<p>The time interval is 1500 hours and <span class="math inline">\(\lambda = 1\)</span></p>
<p><strong>What is the probability that the algorithm will experience more than two failures in 1500 hours?</strong></p>
<p>Similar to the earlier poisson problem, I used ppois to find the probability of <span class="math inline">\(\leq 2\)</span> failures in one time interval and subtracted from 1 to find probability of &gt;2:<br>
<strong>0.080</strong></p>
<p><strong>What is the expected number of failures?</strong></p>
<p>The expected number of failures in 1500 hours is lambda or <strong>1</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># time interval = 1500 hours</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>lambda_1500hours <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># prob of &gt;2 in one time interval</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>prob_pois2_gt2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(<span class="fu">ppois</span>(<span class="at">q =</span> <span class="dv">2</span>, </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">lambda =</span> lambda_1500hours))</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>prob_pois2_gt2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0803014</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected in 1500 hours </span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>exp_1500hrs <span class="ot">&lt;-</span> lambda_1500hours <span class="sc">%*%</span> <span class="dv">1</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>exp_1500hrs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]    1</code></pre>
</div>
</div>
</section>
<section id="uniform" class="level3">
<h3 class="anchored" data-anchor-id="uniform">7. Uniform</h3>
<p><strong>An investor is trying to time the market and is monitoring a stock that they believe has an equal chance of reaching a target price between 20 and 60 days.</strong></p>
<p><strong>Probabilities</strong> For a discrete uniform distribution, every outcome is equally likely so the probability formula is: <span class="math display">\[P(a \leq X \leq b) = \frac{values\ in\ range}{total\ possible\ values}  \]</span></p>
<p><em>What is the probability that the stock will reach the target price in more than 40 days?</em></p>
<p><strong>0.488</strong></p>
<p><em>If it hasn’t reached the target price by day 40, what is the probability that it will reach it in the next 10 days?</em></p>
<p><strong>0.225</strong></p>
<p><strong>What is the expected time for the stock to reach the target price?</strong></p>
<p>Expected value is half the range: <strong>Day 40</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>min_unif <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>max_unif <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>range_unif <span class="ot">&lt;-</span> max_unif <span class="sc">-</span> min_unif <span class="sc">+</span> <span class="dv">1</span> <span class="co"># one extra day if 20-60 inclusive</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>range_unif</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 41</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prob day 41 to day 60  </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>prob_unif_gt40 <span class="ot">&lt;-</span> (max_unif<span class="dv">-40</span>)<span class="sc">/</span>range_unif</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>prob_unif_gt40</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4878049</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prob 41-50, range now 41-60</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>range_41_60 <span class="ot">&lt;-</span> max_unif <span class="sc">-</span> <span class="dv">40</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>range_41_60</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>prob_unif_41_50 <span class="ot">&lt;-</span> (<span class="dv">50-41</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>range_41_60</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>prob_unif_41_50</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected time (max+min)/2</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>expected_unif <span class="ot">&lt;-</span> range_unif<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>expected_unif <span class="co">#days</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>min_unif<span class="sc">+</span>expected_unif <span class="co">#expected day</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40.5</code></pre>
</div>
</div>
</section>
<section id="exponential" class="level3">
<h3 class="anchored" data-anchor-id="exponential">8. Exponential</h3>
<p><strong>A financial model estimates that the lifetime of a successful start-up before it either goes public or fails follows an exponential distribution with an expected value of 8 years. </strong></p>
<p><strong>What is the expected time until the start-up either goes public or fails?</strong></p>
<p>Per the question, the expected time (<span class="math inline">\(\lambda\)</span>) is <em>8 years</em></p>
<p><strong>What is the standard deviation?</strong></p>
<p>The standard deviation for an exponential function is the same as expected value, or <strong>8 years</strong></p>
<p><strong>What is the probability that the start-up will go public or fail after 6 years? </strong></p>
<p><strong>0.472</strong></p>
<p><strong>Given that the start-up has survived for 6 years, what is the probability that it will go public or fail in the next 2 years?</strong></p>
<p>Surviving six years does not impact the probability of what happens in the following two years: <strong>0.221</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>exp_expected <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>exp_lambda <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>exp_expected</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>exp_lambda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.125</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prob &gt;6 </span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>exp_7_8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(<span class="fu">pexp</span>(<span class="dv">6</span>, <span class="at">rate =</span> exp_lambda))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>exp_7_8</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4723666</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prob &lt;=2 </span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>exp_2 <span class="ot">&lt;-</span> <span class="fu">pexp</span>(<span class="dv">2</span>, <span class="at">rate =</span> exp_lambda)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>exp_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2211992</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="problem-2" class="level2">
<h2 class="anchored" data-anchor-id="problem-2">Problem 2</h2>
<section id="product-selection" class="level3">
<h3 class="anchored" data-anchor-id="product-selection">1. Product Selection</h3>
<p><strong>A company produces 5 different types of green pens and 7 different types of red pens. The marketing team needs to create a new promotional package that includes 5 pens. How many different ways can the package be created if it contains fewer than 2 green pens?</strong></p>
<p>There are two ways to do this, either 0 or 1 green pens. Summing the combinations gives us <strong>196</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose five red pens from 7 total red pens</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>case1_pens <span class="ot">&lt;-</span> <span class="fu">choose</span>(<span class="dv">7</span>,<span class="dv">5</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>case1_pens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose four red pens from 7 red pens AND one green pen from five green pens</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>case2_pens <span class="ot">&lt;-</span> <span class="fu">choose</span>(<span class="dv">7</span>,<span class="dv">4</span>) <span class="sc">*</span> <span class="fu">choose</span>(<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>case2_pens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 175</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add them together</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>combined_cases_pens <span class="ot">&lt;-</span> case1_pens<span class="sc">+</span>case2_pens</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>combined_cases_pens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 196</code></pre>
</div>
</div>
<p>###2. Team Formation for a Project</p>
<p><strong>A project committee is being formed within a company that includes 14 senior managers and 13 junior managers. How many ways can a project team of 5 members be formed if at least 4 of the members must be junior managers?</strong></p>
<p>Similar to above, there are two ways to do this: either choose five juniors or four juniors and one senior: <strong>11,297</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>senior_mgr <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>junior_mgr <span class="ot">&lt;-</span> <span class="dv">13</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># five total, four or five must be junior</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># choose five junior from 13</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>case1_team <span class="ot">&lt;-</span> <span class="fu">choose</span>(junior_mgr,<span class="dv">5</span>)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>case1_team</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1287</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose four junior from 13 AND one senior from 14</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>case2_team <span class="ot">&lt;-</span> <span class="fu">choose</span>(junior_mgr,<span class="dv">4</span>) <span class="sc">*</span> <span class="fu">choose</span>(senior_mgr,<span class="dv">1</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>case2_team</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10010</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add them together</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>combined_cases_team <span class="ot">&lt;-</span> case1_team<span class="sc">+</span>case2_team</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>combined_cases_team</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11297</code></pre>
</div>
</div>
</section>
<section id="marketing-campaign-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="marketing-campaign-outcomes">3. Marketing Campaign Outcomes</h3>
<p><strong>A marketing campaign involves three stages: first, a customer is sent 5 email offers; second, the customer is targeted with 2 different online ads; and third, the customer is presented with 3 personalized product recommendations. If the email offers, online ads, and product recommendations are selected randomly, how many different possible outcomes are there for the entire campaign?</strong></p>
<p>We can find the possible combinations of these three types of outreach by multiplying the options for each: <strong>30</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>ads_email <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>ads_online <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>ads_recs <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>ads_combinations <span class="ot">&lt;-</span> ads_email<span class="sc">*</span>ads_online<span class="sc">*</span>ads_recs</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>ads_combinations</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30</code></pre>
</div>
</div>
</section>
<section id="product-defect-probability" class="level3">
<h3 class="anchored" data-anchor-id="product-defect-probability">4. Product Defect Probability</h3>
<p><strong>A quality control team draws 3 products from a batch of size N without replacement. What is the probability that at least one of the products drawn is defective if the defect rate is known to be consistent? </strong></p>
<p>This is a hypergeometric probability problem and while we do not know the defect rate, we could find the probability of zero defects in R with <strong>dhyper function</strong> and then subtract from 1 to find the probability of at least one defect.</p>
</section>
<section id="business-strategy-choices" class="level3">
<h3 class="anchored" data-anchor-id="business-strategy-choices">5. Business Strategy Choices</h3>
<p>** A business strategist is choosing potential projects to invest in, focusing on 17 high-risk, high-reward projects and 14 low-risk, steady-return projects.**</p>
<p><em>Step 1: How many different combinations of 5 projects can the strategist select?</em></p>
<p>Choose five from 31: <strong>169,911</strong></p>
<p><em>Step 2: How many different combinations of 5 projects can the strategist select if they want at least one low-risk project?</em></p>
<p>This is the difference between all possible combinations of five (above) and the number of combinations that are ALL high-risk: <strong>163,723</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>high_risk <span class="ot">&lt;-</span> <span class="dv">17</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>low_risk <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># combinations of 5</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>total_proj <span class="ot">&lt;-</span> high_risk<span class="sc">+</span>low_risk</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>case1_proj <span class="ot">&lt;-</span> <span class="fu">choose</span>(total_proj,<span class="dv">5</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>case1_proj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 169911</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combinations of 5, at least one low-risk</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>case2_all_high <span class="ot">&lt;-</span> <span class="fu">choose</span>(high_risk,<span class="dv">5</span>) <span class="co"># all high-risk (5 from 17)</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>case2_not_all_high <span class="ot">&lt;-</span> case1_proj <span class="sc">-</span> case2_all_high</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>case2_not_all_high</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 163723</code></pre>
</div>
</div>
</section>
<section id="event-scheduling" class="level3">
<h3 class="anchored" data-anchor-id="event-scheduling">Event Scheduling</h3>
<p><strong>A business conference needs to schedule 9 different keynote sessions from three different industries: technology, finance, and healthcare. There are 4 potential technology sessions, 104 finance sessions, and 17 healthcare sessions to choose from.</strong> <strong>How many different schedules can be made? Express your answer in scientific notation rounding to the hundredths place.</strong></p>
<p>If order doesn’t matter, this is similar to the above combination problems: <span class="math display">\[1.53 \times 10^{13}\]</span></p>
<p>However, if order matters, this is a permutation problem and the formula is <span class="math inline">\(P(n,r) = \frac {n!}{(n-r)!}\)</span> <span class="math display">\[5.55 \times 10^{18}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>tech <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>fin <span class="ot">&lt;-</span> <span class="dv">104</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>health <span class="ot">&lt;-</span> <span class="dv">17</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co"># order doesn't matter</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>total_sesh <span class="ot">&lt;-</span> tech<span class="sc">+</span>fin<span class="sc">+</span>health</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>case_sesh <span class="ot">&lt;-</span> <span class="fu">choose</span>(total_sesh,<span class="dv">9</span>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>case_sesh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15290266473625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># order matters</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>perm_sesh <span class="ot">&lt;-</span> <span class="fu">factorial</span>(total_sesh)<span class="sc">/</span><span class="fu">factorial</span>(total_sesh<span class="dv">-9</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>perm_sesh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5548531897948962816</code></pre>
</div>
</div>
</section>
<section id="book-selection-for-corporate-training" class="level3">
<h3 class="anchored" data-anchor-id="book-selection-for-corporate-training">Book Selection for Corporate Training</h3>
<p>** An HR manager needs to create a reading list for a corporate leadership training program, which includes 13 books in total. The books are categorized into 6 novels, 6 business case studies, 7 leadership theory books, and 5 strategy books.**</p>
<p><em>Step 1: If the manager wants to include no more than 4 strategy books, how many different reading schedules are possible? Express your answer in scientific notation rounding to the hundredths place.</em></p>
<p>As this is a reading list, I assumed order did not matter and calculated the ways to choose 13 books less the ways to choose five strategy books: <span class="math display">\[2.42 \times 10^6\]</span></p>
<p><em>Step 2: If the manager wants to include all 6 business case studies, how many different reading schedules are possible? Express your answer in scientific notation rounding to the hundredths place</em></p>
<p>Similar to the above: <span class="math display">\[3.18 \times 10^4\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>novels <span class="ot">&lt;-</span><span class="dv">6</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>biz <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>lead <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>strat <span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>total_books <span class="ot">&lt;-</span> novels <span class="sc">+</span> biz <span class="sc">+</span> lead <span class="sc">+</span> strat</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>total_books</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all combinations of 13 books</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>case1_all_books <span class="ot">&lt;-</span> <span class="fu">choose</span>(total_books,<span class="dv">13</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>case1_all_books</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2496144</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combinations with five strategy books</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>case2_strat_5 <span class="ot">&lt;-</span> <span class="fu">choose</span>(total_books<span class="sc">-</span>strat, <span class="dv">8</span>) <span class="co"># if five are strategy, ways to choose 8 from other categories</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>case2_strat_5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 75582</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combinations with &lt; five strategy books</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>case3_books_strat_leq4 <span class="ot">&lt;-</span> case1_all_books <span class="sc">-</span> case2_strat_5</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>case3_books_strat_leq4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2420562</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combinations with six business books</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>case4_biz_6 <span class="ot">&lt;-</span> <span class="fu">choose</span>(total_books<span class="sc">-</span>biz, <span class="dv">7</span>) <span class="co"># if six are strategy, ways to choose 7 from other categories</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>case4_biz_6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31824</code></pre>
</div>
</div>
</section>
<section id="product-arrangement" class="level3">
<h3 class="anchored" data-anchor-id="product-arrangement">8. Product Arrangement</h3>
<p><strong>A retailer is arranging 10 products on a display shelf. There are 5 different electronic gadgets and 5 different accessories.</strong> <strong>What is the probability that all the gadgets are placed together and all the accessories are placed together on the shelf? Express your answer as a fraction or a decimal number rounded to four decimal places</strong></p>
<p>This one was challenging: there must be two blocks of five items, which themselves could be displayed as AB or BA.</p>
<p><strong>0.0079</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>electronic <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>accessories <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>total_arrangements <span class="ot">&lt;-</span> <span class="fu">factorial</span>(<span class="dv">10</span>) <span class="co"># possible product line ups</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>total_arrangements</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3628800</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate arrangements of two blocks of five, in any order: </span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>elec_arrangements <span class="ot">&lt;-</span> <span class="fu">factorial</span>(<span class="dv">5</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>acc_arrangements <span class="ot">&lt;-</span> <span class="fu">factorial</span>(<span class="dv">5</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate total possible ways to arrange these two blocks of five items</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>block_arrangements <span class="ot">&lt;-</span> <span class="fu">factorial</span>(<span class="dv">2</span>)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate total desired arrangements of two blocks of five items by type</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>desired_arrangements <span class="ot">&lt;-</span> elec_arrangements <span class="sc">*</span> acc_arrangements <span class="sc">*</span> block_arrangements</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate % desired arrangements as % of total possible</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>prob_desired_arrangement <span class="ot">&lt;-</span> desired_arrangements<span class="sc">/</span>total_arrangements</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>prob_desired_arrangement</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007936508</code></pre>
</div>
</div>
</section>
<section id="expected-value-of-a-business-deal" class="level3">
<h3 class="anchored" data-anchor-id="expected-value-of-a-business-deal">Expected Value of a Business Deal</h3>
<p><strong>A company is evaluating a deal where they either gain $4 for every successful contract or lose $16 for every unsuccessful contract. A “successful” contract is defined as drawing a queen or lower from a standard deck of cards. (Aces are considered the highest card in the deck.)</strong></p>
<p><em>Step 1: Find the expected value of the deal. Round your answer to two decimal places. Losses must be expressed as negative values.</em></p>
<p>The expected value is the sum of (value of outcome x probability of outcome): <span class="math display">\[EV = \sum (Value \times Probability)\]</span> <strong>0.923</strong></p>
<p><em>Step 2: If the company enters into this deal 833 times, how much would they expect to win or lose? Round your answer to two decimal places. Losses must be expressed as negative values.</em></p>
<p><strong>$768.92</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>value_win <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>value_lose <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">16</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>cards_lose <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="dv">4</span> <span class="co">#kings and aces times four suits</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>cards_win <span class="ot">&lt;-</span> <span class="dv">52</span> <span class="sc">-</span> cards_lose</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities of win/lose</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>prob_win <span class="ot">&lt;-</span> cards_win<span class="sc">/</span><span class="dv">52</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>prob_lose <span class="ot">&lt;-</span> cards_lose<span class="sc">/</span><span class="dv">52</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="co"># expected value of a hand</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>expected_value <span class="ot">&lt;-</span> (value_win <span class="sc">*</span> prob_win) <span class="sc">+</span> (value_lose <span class="sc">*</span> prob_lose)</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>expected_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9230769</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected value of 833 hands</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="dv">833</span><span class="sc">*</span>expected_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 768.9231</code></pre>
</div>
</div>
<pre><code>


  
## Problem 3  
  
  
## Problem 4  
  
### 1. Sum of Independently Exponentially Distributed Random Variables  
  
**Scenario: You are managing two independent servers in a data center. The time until the next failure for each server follows an exponential distribution with different rates:**

$\lambda_A = 0.5$ failures per hour  
$\lambda_B = 0.3$ failures per hour  

**Question: What is the distribution of the total time until both servers have failed at least once? Use the moment generating function (MGF) to find the distribution of the sum of the times to failure.**  
  
The exponential distributions of time to failure for our two independently unreliable servers can be added together to find the distribution of the total time until both have failed.  

The MGF of an exponential distribution is: 
$$ M(s) = \frac{\lambda}{(\lambda-s)}$$
  
By multiplying the MGFs of the two independent exponential distributions, we find **the MGF of the distribution of the sum of the times to failure**:  
  
$$ M(s) = \frac{0.5}{(0.5-s)}\cdot\frac{0.3}{(0.3-s)}$$
It is **not an exponential function**; the MGF does not match any defined type of distribution so this describes the distribution fully. 

But we can use R to visualize the shape of the distribution described by the MGF we found: 

::: {.cell}

```{.r .cell-code}
n &lt;- 10000

#generate random numbers for each given distribution
A &lt;- rexp(n, rate = 0.5)
B &lt;- rexp(n, rate = 0.3)

total_hours &lt;- A + B
df_total_hours &lt;- data.frame(total_hours)

df_total_hours %&gt;% 
  ggplot(aes(x = total_hours))+
  geom_histogram(aes(y = after_stat(density)),
                 bins = 50,
                 fill = "steelblue")</code></pre>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment-2---Fox_files/figure-html/MGF_exp-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<p>:::</p>
</section>
<section id="sum-of-independent-normally-distributed-random-variables" class="level3">
<h3 class="anchored" data-anchor-id="sum-of-independent-normally-distributed-random-variables">2. Sum of Independent Normally Distributed Random Variables</h3>
<p><strong>Scenario: An investment firm is analyzing the returns of two independent assets, Asset X and Asset Y. The returns on these assets are normally distributed:</strong></p>
<p>Asset X: <span class="math inline">\(X \sim N(\mu_X = 5\%, \sigma_x^2 = 4\%)\)</span></p>
<p>Asset Y: <span class="math inline">\(Y \sim N(\mu_X = 7\%, \sigma_x^2 = 9\%)\)</span></p>
<p><strong>Question: Find the distribution of the combined return of the portfolio consisting of these two assets using the moment generating function (MGF).</strong></p>
<p>The MGF of a normal distribution is <span class="math inline">\(M(s) = exp(\mu s + \frac{\sigma^2 s^2}{2})\)</span></p>
<p><span class="math inline">\(M_X(s) = exp(.05s + \frac{.04s^2}{2})\)</span><br>
<span class="math inline">\(M_Y(s) = exp(.07s + \frac{.09s^2}{2})\)</span></p>
<p>By multiplying the MGFs, we get the MGF of the sum of the normal distributions:<br>
<span class="math inline">\(M_Z(s) = exp(.05s + \frac{.04s^2}{2}) \cdot exp(.07s + \frac{.09s^2}{2})\)</span> <span class="math display">\[M_Z(s) = exp(0.05s + 0.07s + \frac{0.04s^2 + 0.09s^2}{2})\]</span> <span class="math display">\[M_Z(s)= exp(0.12s + \frac{0.13s^2}{2})\]</span></p>
<p>So this is also a <strong>normal distribution with</strong> <span class="math inline">\(\mu = .12\)</span> <strong>and</strong> <span class="math inline">\(\sigma^2 = .13\)</span></p>
<p>As above, we can also use R to visualize the shape of the combined distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co">#generate random numbers for each given distribution</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">4</span>))</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">7</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">9</span>))</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>total_return <span class="ot">&lt;-</span> A <span class="sc">+</span> B</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>df_total_return <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(total_return)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>df_total_return <span class="sc">%&gt;%</span> </span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> total_return))<span class="sc">+</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">70</span>,</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"darkseagreen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment-2---Fox_files/figure-html/MGF_norm-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sum-of-independent-poisson-distributions-of-random-variables" class="level3">
<h3 class="anchored" data-anchor-id="sum-of-independent-poisson-distributions-of-random-variables">3. Sum of Independent Poisson Distributions of Random Variables</h3>
<p><strong>Scenario: A call center receives calls independently from two different regions. The number of calls received from Region A and Region B in an hour follows a Poisson distribution:</strong></p>
<p>Region X: <span class="math inline">\(X_A \sim Poisson(\lambda_A = 3)\)</span><br>
Region Y: <span class="math inline">\(X_B \sim Poisson(\lambda_B = 5)\)</span></p>
<p><strong>Question: Determine the distribution of the total number of calls received in an hour from both regions using the moment generating function (MGF)</strong></p>
<p>The MGF of a Poisson distribution is <span class="math inline">\(M(s) = exp(\lambda(e^s - 1))\)</span></p>
<p><span class="math inline">\(M_X(s) = exp(3(e^s - 1))\)</span> <span class="math inline">\(M_Y(s) = exp(5(e^s - 1))\)</span></p>
<p>By multiplying the MGFs, we get the MGF of the sum of the Poisson distributions:<br>
<span class="math display">\[M_Z(s) = exp(3(e^s - 1)) \cdot exp(5(e^s - 1))\]</span> <span class="math display">\[M_Z(s) = exp(3+5(e^s - 1))\]</span> <span class="math display">\[M_Z(s) = exp(8(e^s - 1))\]</span></p>
<p>This is <strong>also a Poisson distribution with</strong> <span class="math inline">\(\lambda = 8\)</span></p>
<p>Once again, we can visualize the shape of the combined distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co">#generate random numbers for each given distribution</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="at">lambda =</span> <span class="dv">3</span>)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="at">lambda =</span> <span class="dv">5</span>)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>total_calls <span class="ot">&lt;-</span> A <span class="sc">+</span> B</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>df_total_calls <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(total_calls)</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram - make binwidth = 1 for discrete poisson</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>df_total_calls <span class="sc">%&gt;%</span> </span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> total_calls))<span class="sc">+</span></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"cornflowerblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment-2---Fox_files/figure-html/MGF_pois-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="problem-5" class="level2">
<h2 class="anchored" data-anchor-id="problem-5">Problem 5</h2>
<section id="customer-retention-and-churn" class="level3">
<h3 class="anchored" data-anchor-id="customer-retention-and-churn">1. Customer Retention and Churn</h3>
<p><strong>Scenario: A telecommunications company wants to model the behavior of its customers regarding their likelihood to stay with the company (retention) or leave for a competitor (churn).</strong></p>
<p><em>From State 1 (Retention): 80% stay in State 1, 15% move to State 2, and 5% move to State 3.</em><br>
<em>From State 2 (At-risk): 30% return to State 1, 50% stay in State 2, and 20% move to State 3.</em><br>
<em>From State 3 (Churn): 100% stay in State 3.</em></p>
<p><strong>(a) Construct the transition matrix for this Markov Chain</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>M_churn <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">15</span>, .<span class="dv">05</span>,</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>                    .<span class="dv">3</span>, .<span class="dv">5</span>, .<span class="dv">2</span>,</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(M_churn) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Retention"</span>,<span class="st">"At-Risk"</span>,<span class="st">"Churn"</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(M_churn) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Retention"</span>,<span class="st">"At-Risk"</span>,<span class="st">"Churn"</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>M_churn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Retention At-Risk Churn
Retention       0.8    0.15  0.05
At-Risk         0.3    0.50  0.20
Churn           0.0    0.00  1.00</code></pre>
</div>
</div>
<p><strong>(b) If a customer starts as satisfied (State 1), what is the probability that they will eventually churn (move to State 3)? </strong></p>
<p>This is an absorbing Markov chain where Churn is the absorbing state, so we can calculate the probability per the below methodology.</p>
<p>The probability that a customer who starts in Retention will eventually churn is <strong>100%</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q matrix - to transient states</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>Q_churn <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(.<span class="dv">8</span>,.<span class="dv">15</span>,</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>                    .<span class="dv">3</span>,.<span class="dv">5</span>),</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Q_churn) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Retention"</span>,<span class="st">"At-Risk"</span>)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Q_churn) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Retention"</span>,<span class="st">"At-Risk"</span>)</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>Q_churn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Retention At-Risk
Retention       0.8    0.15
At-Risk         0.3    0.50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R matrix - to absorbing state</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>R_churn <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">2</span>),</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(R_churn) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Retention"</span>,<span class="st">"At-Risk"</span>)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(R_churn) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Churn"</span>)</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>R_churn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Churn
Retention  0.05
At-Risk    0.20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fundamental matrix </span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co"># N = (I-Q)^-1 or inverse of identity matrix minus Q matrix</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>I_churn <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">2</span>)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>N_churn <span class="ot">&lt;-</span> <span class="fu">solve</span>(I_churn <span class="sc">-</span> Q_churn)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilities of eventual absorption by initial state:</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>NR_churn <span class="ot">&lt;-</span> N_churn <span class="sc">%*%</span> R_churn</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>NR_churn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Churn
Retention     1
At-Risk       1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability of eventual absorption if starting in Retention state:</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>NR_churn[<span class="dv">1</span>,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p><strong>(c) Determine the steady-state distribution of this Markov Chain. What percentage of customers can the company expect to be in each state in the long run?</strong></p>
<p>Steady state can only be calculated for regular chains where any state can be reached from any other. Because this is an absorbing chain, this is not the case.</p>
<p>However, from the above calculations (NR matrix, shown again below) we can see that <strong>100%</strong> of customers will be in Churn in the long run no matter where they started:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>NR_churn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Churn
Retention     1
At-Risk       1</code></pre>
</div>
</div>
<hr>
</section>
<section id="inventory-management-in-a-warehouse" class="level3">
<h3 class="anchored" data-anchor-id="inventory-management-in-a-warehouse">2. Inventory Management in a Warehouse</h3>
<p><strong>Scenario: A warehouse tracks the inventory levels of a particular product using a Markov Chain model. </strong></p>
<p><em>From State 1 (High &gt;100 units): 70% stay in State 1, 25% move to State 2, and 5% move to State 3.</em><br>
<em>From State 2 (Medium 50-100 units): 20% move to State 1, 50% stay in State 2, and 30% move to State 3.</em><br>
<em>From State 3 (Low &lt;50 units): 10% move to State 1, 40% move to State 2, and 50% stay in State 3.</em></p>
<p><strong>(a) Construct the transition matrix for this Markov Chain.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>M_stock <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(.<span class="dv">7</span>, .<span class="dv">25</span>, .<span class="dv">05</span>,</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>                    .<span class="dv">2</span>, .<span class="dv">5</span>, .<span class="dv">3</span>,</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>                    .<span class="dv">1</span>, .<span class="dv">4</span>, .<span class="dv">5</span>),</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(M_stock) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"High"</span>,<span class="st">"Med"</span>,<span class="st">"Low"</span>)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(M_stock) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"High"</span>,<span class="st">"Med"</span>,<span class="st">"Low"</span>)</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>M_stock</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     High  Med  Low
High  0.7 0.25 0.05
Med   0.2 0.50 0.30
Low   0.1 0.40 0.50</code></pre>
</div>
</div>
<p><strong>(b) If the warehouse starts with a high inventory level (State 1), what is the probability that it will eventually end up in a low inventory level (State 3)?</strong></p>
<p>This is not an absorbing Markov chain so the inventory levels will continue to change and it will not end up in any given state permanently.</p>
<p>However, in part C, the steady state distribution shows that the warehouse will spend <em>about 26.7% of the time</em> in the long term when the system is in <em>steady state.</em></p>
<p><strong>(c) Determine the steady-state distribution of this Markov Chain. What is the long-term expected proportion of time that the warehouse will spend in each inventory state</strong></p>
<p>The package “markovchain” can be used to easily find the steady state of this regular Markov chain.</p>
<p>The steady state matrix below shows that in the long term, the expected proportion of the time spent in each state will be:<br>
<strong>High ~34.7%</strong><br>
<strong>Med ~38.7%</strong><br>
<strong>Low ~26.7%</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>mc_stock <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">"markovchain"</span>,</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">transitionMatrix =</span> M_stock,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">states =</span> <span class="fu">c</span>(<span class="st">"High"</span>,<span class="st">"Med"</span>,<span class="st">"Low"</span>))</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>steady_stock <span class="ot">&lt;-</span> <span class="fu">steadyStates</span>(mc_stock)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>steady_stock</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          High       Med       Low
[1,] 0.3466667 0.3866667 0.2666667</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>